None

Parameters:
ALLOW_SOFT_PLACEMENT=True
BATCH_SIZE=64
CHECKPOINT_EVERY=100
DEV_SAMPLE_PERCENTAGE=0.1
DROPOUT_KEEP_PROB=0.5
EMBEDDING_DIM=400
EVALUATE_EVERY=10
FILTER_SIZES=3,4,5
L2_REG_LAMBDA=0.0
LOG_DEVICE_PLACEMENT=False
NEGATIVE_DATA_FILE=./data/spam_100.utf8
NUM_CHECKPOINTS=5
NUM_EPOCHS=200
NUM_FILTERS=128
NUM_LABELS=2
POSITIVE_DATA_FILE=./data/ham_100.utf8

Writing to /Users/jiangqy/Code/cnn_classify_p3/runs/1510124194

Loading data...
vector size: 400
x.shape = (200, 121, 400)
y.shape = (200, 2)
Train/Dev split: 180/20
conv shape: (?, 119, 1, 128)
h shape: (?, 119, 1, 128)
pool shape: (?, 1, 1, 128)
conv shape: (?, 118, 1, 128)
h shape: (?, 118, 1, 128)
pool shape: (?, 1, 1, 128)
conv shape: (?, 117, 1, 128)
h shape: (?, 117, 1, 128)
pool shape: (?, 1, 1, 128)
h_pool shape: (?, 1, 1, 384)
Tensor("Reshape:0", shape=(?, 384), dtype=float32)
Tensor("dropout/dropout/mul:0", shape=(?, 384), dtype=float32)
<class 'tensorflow.python.framework.ops.Tensor'>
Writing to /Users/jiangqy/Code/cnn_classify_p3/runs/1510124194

2017-11-08T14:56:56.881842: step 1, loss 8.64785, acc 0.515625
2017-11-08T14:56:57.942805: step 2, loss 3.82472, acc 0.640625
2017-11-08T14:56:58.867536: step 3, loss 4.67207, acc 0.692308
2017-11-08T14:56:59.963108: step 4, loss 3.03988, acc 0.78125
2017-11-08T14:57:00.966951: step 5, loss 2.91524, acc 0.796875
2017-11-08T14:57:01.774989: step 6, loss 1.41176, acc 0.903846
2017-11-08T14:57:02.794339: step 7, loss 1.25714, acc 0.875
2017-11-08T14:57:03.832422: step 8, loss 0.78943, acc 0.953125
2017-11-08T14:57:04.708715: step 9, loss 0.72657, acc 0.865385
2017-11-08T14:57:05.709195: step 10, loss 1.24413, acc 0.890625

Evaluation:
2017-11-08T14:57:05.831358: step 10, loss 0.446146, acc 0.95
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 0 0 0 0 0 0 1 1 0 1]
The scores are:[[-11.35246468  21.32975769]
 [ -2.81763697  11.44385624]
 [ 28.2447052  -28.36540031]
 [ 28.2447052  -28.36540031]
 [ -9.98765659  11.90912724]
 [ 18.84469795 -11.55245876]
 [ 28.2447052  -28.36540031]
 [  0.94359839   6.62166595]
 [ -8.06808186  13.79121494]
 [-10.24466133  16.53891754]
 [  8.65779781  -0.26156241]
 [ 28.91401482 -21.22844124]
 [ 28.2447052  -28.36540031]
 [ 28.2447052  -28.36540031]
 [ 29.80267715 -26.6990757 ]
 [ 28.2447052  -28.36540031]
 [ -4.31161118   8.25802803]
 [-15.54394913  16.61535072]
 [ 12.06637192  -4.80506372]
 [ -9.82834816  11.60281849]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 1  9]]
The recall is :0.9545454545454546
The precision is :0.95
The f1_score is :0.9522673031026253

2017-11-08T14:57:06.955077: step 11, loss 0.741101, acc 0.90625
2017-11-08T14:57:07.783088: step 12, loss 0.40697, acc 0.942308
2017-11-08T14:57:08.815748: step 13, loss 0.102698, acc 0.984375
2017-11-08T14:57:09.906869: step 14, loss 0.0625064, acc 0.96875
2017-11-08T14:57:10.731314: step 15, loss 1.02108, acc 0.942308
2017-11-08T14:57:11.857490: step 16, loss 0.448864, acc 0.984375
2017-11-08T14:57:12.884163: step 17, loss 0.135241, acc 0.96875
2017-11-08T14:57:13.724969: step 18, loss 0.108267, acc 0.980769
2017-11-08T14:57:14.704438: step 19, loss 0.0880971, acc 0.96875
2017-11-08T14:57:15.703913: step 20, loss 0.115284, acc 0.96875

Evaluation:
2017-11-08T14:57:15.810826: step 20, loss 0.000824271, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-28.50621986  39.14616776]
 [-16.64939499  25.97488594]
 [ 26.4797821  -26.53944016]
 [ 26.4797821  -26.53944016]
 [-25.52145195  27.86063385]
 [ 15.82145405  -8.8154068 ]
 [ 26.4797821  -26.53944016]
 [-12.51272488  19.98637199]
 [-23.17454529  29.41472816]
 [-28.84236145  34.30495071]
 [  0.70872337   8.01333714]
 [ 29.58058929 -20.95073509]
 [ 26.4797821  -26.53944016]
 [ 26.4797821  -26.53944016]
 [ 29.63800049 -25.65994263]
 [ 26.4797821  -26.53944016]
 [-18.02344131  21.90165329]
 [-31.01922607  32.98332596]
 [  5.83061075   1.6916188 ]
 [-25.29527283  27.4635067 ]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

2017-11-08T14:57:16.752005: step 21, loss 0.417247, acc 0.942308
2017-11-08T14:57:17.774970: step 22, loss 0.119674, acc 0.984375
2017-11-08T14:57:18.759408: step 23, loss 0.27818, acc 0.953125
2017-11-08T14:57:19.554223: step 24, loss 0.00261856, acc 1
2017-11-08T14:57:20.527001: step 25, loss 2.9427e-06, acc 1
2017-11-08T14:57:21.487303: step 26, loss 0.000121096, acc 1
2017-11-08T14:57:22.280932: step 27, loss 2.52173e-08, acc 1
2017-11-08T14:57:23.283597: step 28, loss 6.06919e-06, acc 1
2017-11-08T14:57:24.273300: step 29, loss 0.0680742, acc 0.984375
2017-11-08T14:57:25.093597: step 30, loss 0.61172, acc 0.961538

Evaluation:
2017-11-08T14:57:25.196458: step 30, loss 0.000101164, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-31.38983536  41.8123703 ]
 [-18.27244377  27.94320107]
 [ 28.48163414 -28.28815269]
 [ 28.48163414 -28.28815269]
 [-28.03957939  30.53743172]
 [ 19.31099701 -12.24339008]
 [ 28.48163414 -28.28815269]
 [-13.72926521  21.19219971]
 [-25.34300423  31.53899765]
 [-31.78973579  36.91596603]
 [  1.2283721    7.83431673]
 [ 32.09115219 -23.51749039]
 [ 28.48163414 -28.28815269]
 [ 28.48163414 -28.28815269]
 [ 31.94605446 -27.7830677 ]
 [ 28.48163414 -28.28815269]
 [-19.45768166  23.34874535]
 [-33.32145691  35.62385178]
 [  7.65611219   0.35096785]
 [-27.85659409  30.02020264]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

2017-11-08T14:57:26.284816: step 31, loss 0.294149, acc 0.984375
2017-11-08T14:57:27.258845: step 32, loss 0.00698335, acc 1
2017-11-08T14:57:28.055080: step 33, loss 3.4477e-06, acc 1
2017-11-08T14:57:29.033870: step 34, loss 0.373937, acc 0.953125
2017-11-08T14:57:30.052748: step 35, loss 2.02829e-06, acc 1
2017-11-08T14:57:30.919170: step 36, loss 0.00416933, acc 1
2017-11-08T14:57:31.980931: step 37, loss 0.0396807, acc 0.984375
2017-11-08T14:57:33.012580: step 38, loss 0.340975, acc 0.96875
2017-11-08T14:57:33.845380: step 39, loss 0.0165454, acc 0.980769
2017-11-08T14:57:34.839552: step 40, loss 0, acc 1

Evaluation:
2017-11-08T14:57:34.941389: step 40, loss 0.0129796, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-29.79707718  39.83606339]
 [-16.39762497  25.89998436]
 [ 31.27212334 -30.95217705]
 [ 31.27212334 -30.95217705]
 [-26.47726822  28.65431786]
 [ 22.41162872 -15.5562582 ]
 [ 31.27212334 -30.95217705]
 [-11.42811203  18.71115112]
 [-23.70349312  29.41559792]
 [-30.2700119   34.92381668]
 [  3.87515688   5.09120178]
 [ 35.03457642 -26.85305214]
 [ 31.27212334 -30.95217705]
 [ 31.27212334 -30.95217705]
 [ 34.91081238 -30.86328506]
 [ 31.27212334 -30.95217705]
 [-17.2515564   20.93437767]
 [-31.52743912  33.50545883]
 [ 10.9523983   -2.93482423]
 [-26.3403244   28.07954979]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

2017-11-08T14:57:36.039312: step 41, loss 0, acc 1
2017-11-08T14:57:36.866839: step 42, loss 0.0191577, acc 0.980769
2017-11-08T14:57:38.004873: step 43, loss 9.69765e-06, acc 1
2017-11-08T14:57:39.033381: step 44, loss 0.000128765, acc 1
2017-11-08T14:57:39.876809: step 45, loss 0.00265448, acc 1
2017-11-08T14:57:40.940963: step 46, loss 2.27241e-07, acc 1
2017-11-08T14:57:41.947706: step 47, loss 3.57624e-07, acc 1
2017-11-08T14:57:42.783430: step 48, loss 2.29249e-09, acc 1
2017-11-08T14:57:43.840824: step 49, loss 1.13431e-06, acc 1
2017-11-08T14:57:44.912563: step 50, loss 0.0174501, acc 0.984375

Evaluation:
2017-11-08T14:57:45.021370: step 50, loss 0.0241701, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-29.70556831  39.60709381]
 [-16.35474586  25.69122887]
 [ 32.01165771 -31.44138336]
 [ 32.01165771 -31.44138336]
 [-26.32334709  28.39638329]
 [ 23.02647209 -16.32079506]
 [ 32.01165771 -31.44138336]
 [-11.20786953  18.41332436]
 [-23.65267563  28.9793663 ]
 [-30.38361549  34.68901443]
 [  4.31080961   4.78629923]
 [ 35.71580887 -27.60904884]
 [ 32.01165771 -31.44138336]
 [ 32.01165771 -31.44138336]
 [ 35.64773178 -31.51528549]
 [ 32.01165771 -31.44138336]
 [-16.9366703   20.32618713]
 [-31.25410271  33.09886169]
 [ 11.81653404  -3.63306427]
 [-26.20262146  27.82069588]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

2017-11-08T14:57:45.945167: step 51, loss 2.29249e-09, acc 1
2017-11-08T14:57:46.924490: step 52, loss 0.0504013, acc 0.984375
2017-11-08T14:57:47.898100: step 53, loss 1.3932e-06, acc 1
2017-11-08T14:57:48.682398: step 54, loss 0, acc 1
2017-11-08T14:57:50.020169: step 55, loss 3.72529e-09, acc 1
2017-11-08T14:57:51.074642: step 56, loss 0.193863, acc 0.984375
2017-11-08T14:57:51.973682: step 57, loss 4.88296e-07, acc 1
2017-11-08T14:57:53.023975: step 58, loss 0, acc 1
2017-11-08T14:57:53.971173: step 59, loss 1.4156e-07, acc 1
2017-11-08T14:57:54.781126: step 60, loss 2.4071e-07, acc 1

Evaluation:
2017-11-08T14:57:54.881219: step 60, loss 0.000405289, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-32.45072937  42.21053314]
 [-18.80322075  28.04922104]
 [ 30.32884598 -29.67797852]
 [ 30.32884598 -29.67797852]
 [-28.84620476  30.77320862]
 [ 21.33589554 -14.69875813]
 [ 30.32884598 -29.67797852]
 [-13.81424809  20.78668785]
 [-26.0659771   31.11076355]
 [-33.34851074  37.23608398]
 [  2.08538938   6.89761305]
 [ 34.11564255 -25.9490242 ]
 [ 30.32884598 -29.67797852]
 [ 30.32884598 -29.67797852]
 [ 33.932827   -29.79192162]
 [ 30.32884598 -29.67797852]
 [-19.2010746   22.35705948]
 [-33.69299316  35.58436966]
 [  9.90443516  -1.71704721]
 [-28.75217247  30.15847206]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

2017-11-08T14:57:55.984131: step 61, loss 0, acc 1
2017-11-08T14:57:56.975022: step 62, loss 0, acc 1
2017-11-08T14:57:58.103837: step 63, loss 5.43312e-07, acc 1
2017-11-08T14:57:59.160591: step 64, loss 3.72529e-09, acc 1
2017-11-08T14:58:00.177192: step 65, loss 0, acc 1
2017-11-08T14:58:01.038290: step 66, loss 0, acc 1
2017-11-08T14:58:02.051822: step 67, loss 7.45058e-09, acc 1
2017-11-08T14:58:03.128217: step 68, loss 0.000290732, acc 1
2017-11-08T14:58:03.961364: step 69, loss 6.87746e-09, acc 1
2017-11-08T14:58:04.938801: step 70, loss 1.67638e-08, acc 1

Evaluation:
2017-11-08T14:58:05.035671: step 70, loss 3.50142e-05, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-33.89685822  43.63269806]
 [-20.17955589  29.39608955]
 [ 29.2899971  -28.65000916]
 [ 29.2899971  -28.65000916]
 [-30.23582268  32.0563736 ]
 [ 20.34543419 -13.72158909]
 [ 29.2899971  -28.65000916]
 [-15.2640686   22.09490776]
 [-27.43719482  32.31163788]
 [-34.9434166   38.62891006]
 [  0.73350662   8.13796329]
 [ 33.0814209  -24.93479729]
 [ 29.2899971  -28.65000916]
 [ 29.2899971  -28.65000916]
 [ 32.86743927 -28.73975182]
 [ 29.2899971  -28.65000916]
 [-20.47213173  23.49949074]
 [-35.05764389  36.93418121]
 [  8.72857285  -0.565763  ]
 [-30.15625381  31.43356705]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

2017-11-08T14:58:06.106155: step 71, loss 7.13475e-05, acc 1
2017-11-08T14:58:06.999581: step 72, loss 6.96319e-05, acc 1
2017-11-08T14:58:08.031848: step 73, loss 2.44005e-07, acc 1
2017-11-08T14:58:09.004780: step 74, loss 0, acc 1
2017-11-08T14:58:09.789660: step 75, loss 0, acc 1
2017-11-08T14:58:10.784048: step 76, loss 0.000444162, acc 1
2017-11-08T14:58:11.740754: step 77, loss 3.72529e-09, acc 1
2017-11-08T14:58:12.532473: step 78, loss 0, acc 1
2017-11-08T14:58:13.587445: step 79, loss 0.0669025, acc 0.984375
2017-11-08T14:58:14.574610: step 80, loss 0.000154705, acc 1

Evaluation:
2017-11-08T14:58:14.671609: step 80, loss 2.88129e-05, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-34.74636078  44.49842453]
 [-21.08841896  30.24258995]
 [ 28.61306953 -27.9170475 ]
 [ 28.61306953 -27.9170475 ]
 [-31.06808853  32.84740067]
 [ 19.66383553 -13.08178902]
 [ 28.61306953 -27.9170475 ]
 [-16.24945068  22.95597839]
 [-28.28574181  33.08041763]
 [-35.91277695  39.54140854]
 [ -0.18475515   9.03305721]
 [ 32.35661316 -24.2042675 ]
 [ 28.61306953 -27.9170475 ]
 [ 28.61306953 -27.9170475 ]
 [ 32.1492157  -28.01564789]
 [ 28.61306953 -27.9170475 ]
 [-21.29353714  24.24701118]
 [-35.93297958  37.75070572]
 [  7.90797949   0.26013875]
 [-30.9950428   32.23526001]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

2017-11-08T14:58:15.614848: step 81, loss 3.4387e-07, acc 1
2017-11-08T14:58:16.738543: step 82, loss 0.042039, acc 0.984375
2017-11-08T14:58:17.793087: step 83, loss 1.08033e-07, acc 1
2017-11-08T14:58:18.631425: step 84, loss 7.33594e-08, acc 1
2017-11-08T14:58:19.665620: step 85, loss 1.09896e-07, acc 1
2017-11-08T14:58:20.721915: step 86, loss 1.19209e-07, acc 1
2017-11-08T14:58:21.540922: step 87, loss 2.29249e-09, acc 1
2017-11-08T14:58:22.535679: step 88, loss 7.45058e-09, acc 1
2017-11-08T14:58:23.559904: step 89, loss 0, acc 1
2017-11-08T14:58:24.383638: step 90, loss 1.99445e-07, acc 1

Evaluation:
2017-11-08T14:58:24.498298: step 90, loss 5.18435e-05, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-34.51543427  44.47696686]
 [-21.12978745  30.37922096]
 [ 28.44631767 -27.54485703]
 [ 28.44631767 -27.54485703]
 [-30.80756569  32.80007553]
 [ 23.68635559 -16.87789726]
 [ 28.44631767 -27.54485703]
 [-16.32270813  23.18597031]
 [-28.24663734  33.08192444]
 [-35.73029327  39.52617645]
 [ -0.53119808   9.37137318]
 [ 31.96022987 -23.87855148]
 [ 28.44631767 -27.54485703]
 [ 28.44631767 -27.54485703]
 [ 31.91379547 -27.74617958]
 [ 28.44631767 -27.54485703]
 [-21.29131508  24.31990814]
 [-35.8236618   37.69229889]
 [  7.61160517   0.69106758]
 [-30.7547226   32.22644043]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

2017-11-08T14:58:25.628314: step 91, loss 5.30845e-07, acc 1
2017-11-08T14:58:26.688588: step 92, loss 2.42144e-08, acc 1
2017-11-08T14:58:27.514306: step 93, loss 0.000148988, acc 1
2017-11-08T14:58:28.541041: step 94, loss 0.113763, acc 0.984375
2017-11-08T14:58:29.547287: step 95, loss 1.67815e-06, acc 1
2017-11-08T14:58:30.351890: step 96, loss 0, acc 1
2017-11-08T14:58:31.326869: step 97, loss 5.06744e-06, acc 1
2017-11-08T14:58:32.319542: step 98, loss 0, acc 1
2017-11-08T14:58:33.110076: step 99, loss 0, acc 1
2017-11-08T14:58:34.118006: step 100, loss 0, acc 1

Evaluation:
2017-11-08T14:58:34.209562: step 100, loss 2.40831e-05, acc 1
<class 'numpy.ndarray'>
The feature shape is :(20, 384)
The predictions are:[1 1 0 0 1 0 0 1 1 1 1 0 0 0 0 0 1 1 0 1]
The scores are:[[-33.13285065  43.421978  ]
 [-19.88513947  29.5812912 ]
 [ 29.33538437 -28.14537239]
 [ 29.33538437 -28.14537239]
 [-29.42714691  31.85400009]
 [ 25.96533966 -18.86912155]
 [ 29.33538437 -28.14537239]
 [-15.08258629  22.36200142]
 [-26.97340012  32.15248871]
 [-34.30215836  38.5546608 ]
 [  0.47649646   8.56805325]
 [ 32.9031868  -24.52995682]
 [ 29.33538437 -28.14537239]
 [ 29.33538437 -28.14537239]
 [ 33.00395584 -28.46160507]
 [ 29.33538437 -28.14537239]
 [-20.07590675  23.37540627]
 [-34.35358047  36.67019653]
 [  8.7266283    0.07931119]
 [-29.41497421  31.27410889]]
type:<class 'numpy.ndarray'>
type:<class 'numpy.ndarray'>
[[10  0]
 [ 0 10]]
The recall is :1.0
The precision is :1.0
The f1_score is :1.0

Saved model checkpoint to /Users/jiangqy/Code/cnn_classify_p3/runs/1510124194/checkpoints/model-100

2017-11-08T14:58:36.345622: step 101, loss 0, acc 1
2017-11-08T14:58:37.185853: step 102, loss 1.43963e-06, acc 1
2017-11-08T14:58:38.187729: step 103, loss 3.79189e-06, acc 1
2017-11-08T14:58:39.176249: step 104, loss 0, acc 1
2017-11-08T14:58:39.973388: step 105, loss 6.80856e-07, acc 1
2017-11-08T14:58:40.994075: step 106, loss 1.86265e-09, acc 1
2017-11-08T14:58:42.025977: step 107, loss 4.92411e-06, acc 1